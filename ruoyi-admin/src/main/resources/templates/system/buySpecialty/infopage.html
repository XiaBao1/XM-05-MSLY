<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" >
<head>
    <th:block th:include="include :: header('修改房iii间订购')" />
</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-buyRoom-buy" >
        <!--    <form class="form-horizontal m" id="form-buyroom-buy" th:object="${buyRoom}">-->
        <div class="form-group" hidden>
            <label class="col-sm-3 control-label">特产ID：</label>
            <div class="col-sm-8">
                <input name="houseId"  class="form-control" th:value="${id}" type="number" id="id" required disabled >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">特产名称：</label>
            <div class="col-sm-8">
                <input name="houseId"  class="form-control"  th:value="查询中" type="text" id="specialtyName" required disabled >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">特产单价（￥）：</label>
            <div class="col-sm-8">
                <input name="houseId"  class="form-control"  th:value="查询中" type="text" id="price" required disabled >
            </div>
        </div>
        <div class="form-group" hidden>
            <label class="col-sm-3 control-label">民宿ID：</label>
            <div class="col-sm-8">
                <input name="houseId"  class="form-control"  th:value="查询中" type="text" id="houseId" required disabled >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">民宿名称：</label>
            <div class="col-sm-8">
                <input name="houseId"  class="form-control"  th:value="查询中" type="text" id="houseName" required disabled>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">库存：</label>
            <div class="col-sm-8">
                <input name="houseId"  class="form-control"  th:value="查询中" type="text" id="inventory" required disabled >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">订购数量：</label>
            <div class="col-sm-8">
                <input name="houseName"  class="form-control" type="number" id="buyNumber" oninput="if(value<1)value=1" placeholder="请输入>=1的整数" >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label " th:size="10">支付密码(开启安全支付)：</label>
            <div class="col-sm-8">
                <input name="pricePerDay" class="form-control" type="password" id="pwd" maxlength="6" minlength="6" placeholder="请输入6位支付密码" >
            </div>
        </div>
    </form>
    <div>
        <p style="text-align: right">
            <button th:style="'background:#1E90FF;border-style:none;color:#ffff;border-radius:5px;height:30px;width:50px'" name="dg" id="dg" onclick="confirm()">确认</button>
        </p>
    </div>

</div>



<th:block th:include="include :: footer" />
<th:block th:include="include :: summernote-js" />
<script th:inline="javascript" >
    console.log("进入infopage的js");
    var houseName,specialtyName,houseId,inventory,price;
    var id=$("#id").val();
    console.log("id="+id);
    var data={};
    data.id=id;
    $.ajax({//获取房间信息
        type: 'post',
        url: '/system/buySpecialty/getSpecialtyInfo',
        async: false,
        data: data,
        success: function(res) {
            console.log(res);
            let json = eval( "(" + res + ")" );
            specialtyName= json.specialtyName;
            houseId=json.houseId;
            price=json.price;
            houseName=json.houseName;
            inventory=json.inventory;
        }
    });
    document.getElementById("specialtyName").value=specialtyName;
    document.getElementById("houseId").value=houseId;
    document.getElementById("price").value=price;
    document.getElementById("inventory").value=inventory;
    document.getElementById("houseName").value=houseName;

    function confirm() {
        console.log("进入confirm");
        data.pwd=$("#pwd").val();
        data.buyNumber=$("#buyNumber").val();
        console.log(data);

        $.ajax({
            type: 'post',
            url: '/system/buySpecialty/pay',
            async: false,
            data: data,
            success: function(res) {
                console.log(res);
                let json = eval( "(" + res + ")" );
                if(json.result_code==0){
                    top.layer.alert("下单成功");
                    $.modal.openTab('特产订购', '/system/buySpecialty/buySpecialty');
                }
                else{
                    top.layer.alert(json.result_msg);
                }
            }
        });
    }


</script>


</body>


</html>
